{% extends "admin/base.html" %} {% block content %}
<div class="container-sm mt-5">
    <div class="d-flex flex-row bd-highlight mb-3">
        <div class="p-2 bd-highlight">
            <p>ID: {{ article.id }}</p>
        </div>
        <div class="p-2 bd-highlight">
            <p>DATE_CREATED: {{ article.created_at }}</p>
        </div>
        <div class="p-2 bd-highlight">
            <p>DATE_UPDATED: {{ article.updated_at }}</p>
        </div>
    </div>
</div>
<div class="container-sm mt-3">
    <label for="comment">Title:</label>
    <textarea class="form-control" rows="1" id="title" name="text">{{ article.title }}</textarea>
</div>
<div class="container mt-3">
    <label for="comment">Content:</label>
    <textarea class="form-control" rows="6" id="content" name="text">{{ article.content }}</textarea>
</div>
<div class="container mt-3">
<div class="d-flex flex-row bd-highlight mb-3">
<div class="p-2 bd-highlight">
    <button id="updateButton" type="button" class="btn btn-success">Update Article</button>
</div>
<div class="p-2 bd-highlight">
    <button id="deleteButton" type="button" class="btn btn-danger">Delete Article</button>
</div>
<div class="form-check form-switch">
    <input class="form-check-input" type="checkbox" id="mySwitch" name="darkmode" value="yes">
    <label class="form-check-label" for="mySwitch">Hidden</label>
</div>
</div>
</div>

<script>
    if ("{{ article.hidden }}" === "True") {
        document.getElementById("mySwitch").checked = true
    } else {
        document.getElementById("mySwitch").checked = false
    }
    document.getElementById("deleteButton").addEventListener("click", () => {
        fetch("{{ url_for('delete_article', article_id=article.id) }}", {
            method: "DELETE"
        }).then(() => {
            location.replace("{{ url_for('admin_page') }}")
        })
    })
    document.getElementById("updateButton").addEventListener("click", () => {
        data = {
                "title": document.getElementById("title").value,
                "content": document.getElementById("content").value,
                "hidden": document.getElementById("mySwitch").checked
            }
        fetch("{{ url_for('update_article', article_id=article.id )}}", {
            method: "PUT",
            body: JSON.stringify(data),
            headers: {
                "Content-Type": "application/json",
            },
        }).then(() => {
            location.replace("{{ url_for('admin_page') }}")
        })
    })
</script>
{% endblock %}

